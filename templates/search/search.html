{% extends 'base_wide.html' %}

{% block content %}


<div class="search-results-head results-head">
    <h2>Search Results</h2>
    <div class="grid-list-selector">
		<div class="display-as">Display as:</div>
		<button class="list">List View</button>
		<button class="grid">Grid View</button>
	</div>
	<div class="pagination">
		{% load paginator %}{% paginator 4 extra_class="top" %}
		<div class="results-count">Results {{page.start_index}} to {{page.end_index}} of {{page.paginator.count}}</div>
	</div>
</div><!-- /search-results-head -->

<!-- Begin faceting. -->
<div class="filter-bar">
<form id="filter-form">
    <div class="filter-clear">
        <p>Filter results: 
        <button type="clear" class="btn">Clear</button>
        </p>
    </div>
<h2>By Category</h2>
    <div>
        <dl>
            <dt>Categories</dt>
            {% if form.categories %}
                <dd>
                    {{ form.categories }}
                </dd>
            {% else %}
                <dd>None</dd>
            {% endif %}
        </dl>
    </div>
    <div>
        <dl>
            <dt>Item name</dt>
            {% if form.item_name %}
                <dd>
                    {{ form.item_name }}
                </dd>
            {% else %}
                <dd>None</dd>
            {% endif %}
        </dl>
    </div>
<h2>Places</h2>
    <div>
        <dl>
            <dt>Global region</dt>
            {% if form.global_region %}
                <dd>
                    {{ form.global_region }}
                </dd>
            {% else %}
                <dd>None</dd>
            {% endif %}
        </dl>
    </div>
    <div>
        <dl>
            <dt>Country</dt>
            {% if form.country %}
                <dd>
                    {{ form.country }}
                </dd>
            {% else %}
                <dd>None</dd>
            {% endif %}
        </dl>
    </div>
<h2>People</h2>
    <div>
        <dl>
            {{form.person}}
        </dl>
    </div>
    <div>
        <dl>
            {% if facets.fields.has_images %}
                <label for="has_images">
                	<input type="checkbox" id="has_images" name="has_images" value="True">
                	Only return results with an associated image
                </label>
                {# Provide only the top 5 has_images #}
                {% for has_images in facets.fields.has_images|slice:":5" %}
                    <dd><a href="{{ request.get_full_path }}&amp;selected_facets=has_images_exact:{{ has_images.0|urlencode }}">{{ has_images.0 }}</a> ({{ has_images.1 }})</dd>
                {% endfor %}
            {% else %}
                <p>No has_images facets.</p>
            {% endif %}
        </dl>
    </div>
</form>
</div>

    <!-- End faceting -->

{% if query %}
<div class="search-results list-view">
    <table class="search-results">
        <tr><th></th><th>Item</th><th>Category</th><th>Place</th></tr>
    {% for result in page.object_list %}
        <tr>
            <td class="thumbnail">
                <a href="{{ result.object.get_absolute_url }}?search_result={{forloop.counter0|add:page.start_index}}">
                    <img src="{% firstof result.object.artefactrepresentation_set.all.0.image.url_105x70 "http://placehold.it/105x70" %}" width="105" height="70" alt="">
                </a>
            </td>
            <td class="item">
                <a href="{{ result.object.get_absolute_url }}?search_result={{forloop.counter0|add:page.start_index}}">
                    <span class="item_type">{{ result.object.artefact_type }}</span><br>
                <span class="registration_number">Registration No. <span class="number">{{ result.object.registration_number }}</span></span>
                </a>
            </td>
            <td class="category">
                {% for category in result.object.category.all %}
                    <a href="{{ category.get_absolute_url }}">{{ category.name }}</a><br>
                {% endfor %}
            </td>
            <td class="place">
                  <a href="{{result.object.global_region.get_absolute_url}}">
                    {{ result.object.global_region }}</a>
                    >
                  <a href="{{result.object.country.get_absolute_url}}">
                    {{ result.object.country }}</a>
            </td>
    {% empty %}
        <tr><td colspan="4">No results found.</td></tr>
    {% endfor %}
    </table>

    {% load paginator %}{% paginator 4 extra_class="bottom" %}
</div><!-- /search-results -->
{% else %}
    {# Show some example queries to run, maybe query syntax, something else? #}
    <p class="no-results">Use the search options above or browse by categories, people, or places to view the collection.</p>
{% endif %}
{% endblock %}



{% block javascript %}

<script type="text/javascript">
$(document).ready(function () {
    $('#filter-form input').click(function() {
        $('#filter-form :checked').clone().hide().appendTo('form#main-search');
        $('#filter-form :text').clone().hide().appendTo('form#main-search');

        $('form#main-search').submit();

    });


});
</script>
{% endblock javascript %}